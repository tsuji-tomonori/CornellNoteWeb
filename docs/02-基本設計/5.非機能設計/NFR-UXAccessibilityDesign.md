# UX/アクセシビリティ設計（NFR-UX）

## 対応NFR
NFR-UX-001〜026（アクセシビリティはWCAG 2.2 AA相当を中心）

## 基本方針
- 主要フロー（ログイン、ノート編集、検索、共有閲覧、退会）を「支援技術・キーボードのみ」で完遂可能にする。
- アクセシビリティは「後から直す」ではなく、デザインシステム/CI/CDゲート/テストで継続担保する（NFR-UX-023）。

## エラーメッセージ（UX-001）
- 利用者向けエラーは以下を含む
  - 原因カテゴリ（入力不備/権限/一時障害 等）
  - 利用者が取るべき対応（再試行、入力修正、問い合わせ 等）
  - 問い合わせ用識別子（traceId）
- APIレスポンスは docs/02-基本設計/4.API設計/API-ErrorModel.md に準拠

## サポート対象（UX-002）
- 対象ブラウザ/端末（最新2世代等）を定義し、主要UCの動作確認結果をリリースごとに保存

## WCAG 2.2 AA相当のUI要件
### 色とコントラスト（UX-003, UX-006）
- 通常テキスト 4.5:1以上、大きなテキスト 3:1以上、非テキストUI 3:1以上
- 状態（エラー等）は色以外（アイコン/テキスト等）でも識別可能

### 代替テキスト/アクセシブルネーム（UX-004）
- すべての操作要素に一意のアクセシブルネーム
- 情報画像はaltで意味を説明、装飾画像は空alt

### マルチメディア（UX-005）
- 動画: 同期字幕（必要なら音声解説/代替テキスト）
- 音声: 文字起こし

### リフロー/拡大/向き（UX-007）
- 200%拡大、幅320CSS px相当でも主要機能が利用可能（水平スクロール最小化）

### キーボード操作/フォーカス（UX-008, UX-009）
- キーボードのみで主要機能完結、フォーカストラップ禁止
- フォーカス順序は論理的、スキップリンク等を提供
- フォーカスは常に視認可能、固定要素で隠れない

### ターゲットサイズ（UX-010）
- 24×24CSS px以上（例外は根拠を記録）

### ドラッグ/ジェスチャ代替（UX-011, UX-012）
- D&Dはボタン等の代替手段
- 複雑ジェスチャ必須禁止、破壊的操作は確認/取消手段

### ページ構造/ナビゲーション（UX-013）
- 一意なタイトル、論理的見出し、ランドマークを付与
- 主要ページへ複数経路（メニュー/パンくず/検索等）

### フォーム（UX-014）
- ラベル関連付け、制約事前説明、エラーをテキストで提示
- 重大操作は送信前確認/取消手段

### 再入力最小化（UX-015）
- 同一プロセス内の再入力を避け、自動入力/選択再利用を提供

### 認証（UX-016）
- CAPTCHA等はアクセシブルな代替手段を用意
- パスワードマネージャ、コピー/ペーストを妨げない

### ヘルプ一貫性（UX-017）
- FAQ/問い合わせ等の導線をページ間で一貫配置

### タイムアウト配慮（UX-018）
- 事前通知＋延長/再開手段
- 入力内容喪失最小化（自動保存など：ノート編集と整合）

### 状態変化通知（UX-019）
- aria-live等で支援技術に通知、不要なフォーカス移動禁止

### 点滅（UX-020）
- 3回/秒を超える閃光禁止

### 堅牢性（UX-021）
- HTML/ARIA準拠（lint/validatorで重大違反0）
- 支援技術×ブラウザの主要組合せで主要フロー完遂を確認し記録

### 資料/通知（UX-022）
- メールは構造化HTMLで作成、画像のみで情報伝達しない
- PDF提供時はタグ付け/読み順/代替テキスト等を配慮

## 継続担保（UX-023, UX-024, UX-025）
- CI/CDでアクセシビリティ自動検査を必須ゲート化（重大違反は0件）
- サードパーティは導入前に声明/VPAT等取得＋自社検査、問題があれば代替/緩和を記録
- 問い合わせ窓口と是正プロセス（SLA）を定義

## 言語指定（UX-026）
- ページ言語をlang属性で指定
- 部分的に別言語の箇所は部分langを適用

## 受入/検証
- 自動検査（CI）＋手動検査（キーボード/スクリーンリーダー）＋デザインレビューをセットで実施
- 結果はリリースごとに保管し、監査要求に提示可能にする（NFR-PRC-008）
