# SLO/SLI定義（詳細）

## 対応NFR
- NFR-AV-001, NFR-OPS-002, NFR-OPS-008
- NFR-PS-001, NFR-PS-002, NFR-PS-003

## SLO一覧（具体値）
- 可用性SLO（月次）: 99.9%（月次エラーバジェット 43.2分）
- API遅延SLO: 主要API p95 server time <= 300ms / p99 <= 800ms
- 体感SLO: 主要操作 p95 <= 2.0s / p99 <= 4.0s
- エラー率SLO: 主要APIの5xx+timeout比率 <= 0.5%（1日単位）
- 429発生率: 主要API 429比率 <= 0.2%（1日単位）

## SLI定義（例：API成功率）
- 成功 = HTTP 2xx/3xx
- 失敗 = 5xx + タイムアウト + LB/ゲートウェイ起因エラー
- 除外 = 明示的なクライアント起因(4xx)（ただし429は別集計）
- 分子/分母
  - 成功率 = 成功リクエスト数 / 総リクエスト数（成功+失敗+429）

## 集計方法
- 観測ソース: APM（サーバ処理時間）, ログ（statusCode）, RUM（体感）
- 集計窓: SLO=月次/週次, アラート=5分/30分
- ラベル: env/service/endpoint/clientType
- 時刻: UTC, 1分粒度で集計

## エラーバジェット運用
- 算定式: 月間総時間 * (1 - 可用性SLO)
- ルール
  - 50%消費: 変更凍結（機能追加を停止、バグ修正のみ）
  - 80%消費: 緊急改善発動（優先度P0）、リリース停止
  - 95%消費: 原因分析完了まで全リリース停止
- 例外
  - 緊急セキュリティパッチはCTO承認で実施可
